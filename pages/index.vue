<template>
  <div>
    <header>
      <div class="container">
          <div class="header__inner">
              <a href="#">
                  <svg id="logo" viewBox="0 0 546 232" version="1.1" xmlns="http://www.w3.org/2000/svg">
                      <g id="#00d188ff">
                      <path fill="#00d188" opacity="1.00" d=" M 24.92 8.78 C 32.47 4.92 40.47 1.68 49.00 0.96 C 59.17 0.02 69.71 1.67 78.88 6.25 C 89.17 10.84 98.58 17.46 106.51 25.46 C 107.35 26.55 108.81 27.47 108.79 28.99 C 109.17 31.14 107.22 32.54 105.99 33.98 C 99.51 40.42 91.92 45.63 84.04 50.20 C 82.98 50.69 81.91 51.18 80.86 51.68 C 69.00 57.85 54.87 59.82 41.84 56.63 C 31.39 54.34 22.05 48.74 13.40 42.64 C 9.01 39.43 4.89 35.79 1.28 31.71 C 0.12 30.61 -0.03 28.41 1.11 27.25 C 7.75 19.60 16.22 13.84 24.92 8.78 M 49.92 7.61 C 46.40 8.96 42.75 10.32 39.99 13.00 C 33.04 18.57 30.92 28.73 33.86 36.94 C 35.72 42.81 40.62 47.25 46.11 49.76 C 47.66 50.30 49.22 50.82 50.77 51.38 C 59.86 52.77 69.32 48.16 73.93 40.24 C 77.31 34.17 77.73 26.53 74.72 20.23 C 71.84 13.84 65.67 9.54 59.08 7.60 C 56.03 7.36 52.97 7.37 49.92 7.61 Z" />
                      <path fill="#00d188" opacity="1.00" d=" M 41.62 19.63 C 46.34 13.49 55.24 11.84 62.09 15.17 C 56.89 18.63 56.70 27.54 62.18 30.81 C 64.61 32.73 67.78 32.38 70.68 32.41 C 69.12 36.54 67.08 40.87 63.03 43.10 C 55.74 47.64 44.92 45.24 40.76 37.57 C 37.31 32.07 38.04 24.88 41.62 19.63 Z" />
                      <path fill="#00d188" opacity="1.00" d=" M 196.62 130.05 C 196.63 110.62 196.62 91.20 196.63 71.77 C 204.49 71.74 212.35 71.74 220.22 71.77 C 220.25 91.18 220.16 110.59 220.26 130.00 C 220.66 136.42 221.83 143.61 226.88 148.11 C 228.13 149.28 229.50 150.32 230.86 151.37 C 236.29 153.69 242.22 154.12 248.03 153.32 C 249.11 152.99 250.19 152.64 251.26 152.27 C 255.30 150.41 259.13 147.67 261.19 143.61 C 263.68 138.46 264.43 132.66 264.51 127.00 C 264.50 108.58 264.50 90.17 264.51 71.75 C 272.17 71.75 279.83 71.75 287.50 71.75 C 287.36 92.87 287.78 114.00 287.28 135.11 C 286.30 139.45 285.91 143.96 284.18 148.11 C 280.21 159.67 269.91 168.75 258.05 171.53 C 251.74 166.21 243.22 165.70 235.37 166.65 C 233.91 167.19 232.44 167.72 230.98 168.26 C 228.96 169.24 227.01 170.35 225.06 171.48 C 214.29 168.26 205.13 160.36 200.57 150.05 C 200.51 149.81 200.40 149.32 200.34 149.07 C 199.27 146.79 198.52 144.39 198.02 141.93 C 197.24 138.01 196.63 134.04 196.62 130.05 Z" />
                      <path fill="#00d188" opacity="1.00" d=" M 230.22 176.15 C 240.27 171.71 252.88 173.55 261.02 181.03 C 265.66 185.09 268.58 190.80 270.05 196.73 C 271.99 206.55 268.56 217.34 261.00 223.98 C 250.27 234.10 231.25 233.76 221.39 222.57 C 217.49 218.97 215.18 214.12 213.62 209.13 C 212.88 202.64 212.97 195.93 215.75 189.89 C 219.26 184.19 223.82 178.68 230.22 176.15 Z" />
                      </g>
                      <g id="#000000ff">
                      <path fill="#000000" opacity="1.00" d=" M 123.92 71.08 C 136.36 69.13 149.51 69.80 161.23 74.70 C 167.83 77.50 173.49 82.05 178.40 87.21 C 173.40 91.97 168.33 96.66 163.25 101.33 C 157.57 95.53 150.21 90.83 141.95 90.17 C 131.96 88.73 121.15 91.65 113.93 98.89 C 107.16 104.85 104.64 114.29 104.87 123.04 C 105.16 132.48 109.28 142.29 117.41 147.55 C 128.08 155.40 143.19 155.50 154.72 149.47 C 154.63 139.77 154.75 130.08 154.65 120.39 C 156.73 120.12 158.83 119.81 160.94 119.99 C 166.13 120.43 171.35 119.18 176.50 120.35 C 176.38 133.83 176.43 147.31 176.48 160.78 C 161.80 171.74 142.47 175.60 124.53 172.71 C 113.24 171.06 102.82 165.22 94.73 157.28 C 88.45 150.26 83.69 141.64 81.99 132.31 C 80.17 120.72 80.93 108.22 86.72 97.77 C 93.81 83.50 108.32 73.61 123.92 71.08 Z" />
                      <path fill="#000000" opacity="1.00" d=" M 40.51 71.75 C 48.38 71.75 56.25 71.75 64.12 71.75 C 64.13 105.13 64.11 138.50 64.13 171.87 C 56.25 171.88 48.38 171.87 40.51 171.88 C 40.50 138.50 40.50 105.13 40.51 71.75 Z" />
                      <path fill="#000000" opacity="1.00" d=" M 310.00 71.75 C 316.03 71.81 322.05 71.64 328.08 71.79 C 329.56 71.58 330.31 73.09 331.02 74.09 C 342.77 93.88 354.76 113.52 366.59 133.26 C 370.75 127.33 374.08 120.88 377.98 114.79 C 385.53 101.52 393.70 88.61 401.18 75.30 C 402.15 73.92 402.87 71.62 404.96 71.79 C 410.93 71.63 416.90 71.81 422.87 71.75 C 422.90 96.16 422.84 120.56 422.90 144.96 C 423.45 153.90 423.14 162.86 423.23 171.81 C 415.91 171.95 408.60 171.83 401.29 171.89 C 401.50 153.58 400.75 135.25 401.83 116.97 C 401.97 115.43 401.29 114.02 400.64 112.68 C 401.53 117.51 401.83 122.45 400.85 127.30 C 400.45 123.05 400.71 118.76 400.51 114.50 C 397.18 117.06 395.89 121.23 393.69 124.65 C 386.25 136.75 379.13 149.04 371.88 161.26 C 368.25 161.38 364.61 161.37 360.99 161.28 C 351.54 145.61 342.02 130.00 332.47 114.40 C 332.15 133.49 332.34 152.59 332.37 171.68 C 324.92 172.07 317.46 171.79 310.00 171.88 C 310.00 138.50 310.00 105.13 310.00 71.75 Z" />
                      <path fill="#000000" opacity="1.00" d=" M 433.24 171.74 C 448.22 138.45 462.88 105.03 477.91 71.77 C 485.61 71.75 493.32 71.70 501.03 71.80 C 508.31 87.41 514.91 103.33 522.22 118.93 C 529.83 136.67 538.19 154.08 545.66 171.88 C 537.50 171.67 529.30 172.28 521.18 171.59 C 517.95 164.64 515.13 157.49 512.29 150.37 C 496.86 150.41 481.42 150.28 465.99 150.44 C 463.66 157.81 459.97 164.65 457.26 171.88 C 449.26 171.79 441.24 172.04 433.24 171.74 M 488.68 96.21 C 483.88 108.35 478.64 120.33 473.95 132.51 C 484.21 132.61 494.47 132.55 504.74 132.55 C 504.62 132.11 504.39 131.22 504.28 130.78 C 499.20 119.53 494.81 107.97 490.14 96.54 C 489.77 96.46 489.05 96.29 488.68 96.21 Z" />
                      </g>
                  </svg>
              </a>
              <div id="burger">
                <div class="first"></div>
                <div class="second"></div>
                <div class="third"></div>
              </div>
              <nav>
                  <a href="#about">О проекте</a>
                  <a href="#howToBuy">Как купить?</a>
                  <a href="#tokenomics">Токеномика</a>
                  <a href="#roadmap">Дорожная карта</a>
                  <a href="#" id="telegram-nav" class="btn">Telegram</a>
              </nav>
          </div>
      </div>
    </header>
    <main>
      <section class="fullpage" id="banner">
          <img class="union first" src="img/banner-union.png" alt="">
          <img class="union second" src="img/banner-union.png" alt="">
          <div class="description">
              <h1>Digital Human NFT</h1>
              <p>Твой личный персональный DeepFake-аватар в виде NFT для метавселенной и соцсетей</p>
              <div class="beehives">
                  <div class="beehive beehive-first">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                  </div>
                  <div class="beehive beehive-second">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                      <img src="img/polygon.png" alt="">
                  </div>
              </div>
          </div>
          <div class="hexagonBorder clip-img">
              <img class="" src="img/banner-image.png" alt="">
          </div>
          <div class="telegram">
              <svg viewBox="0 0 600 200">
                  <image href="img/telegram-skewed.png" alt="" />
                  <path d="M160 120 H400 V60 H600" fill="none" />
              </svg>
              <a href="#" class="btn">Telegram<br>@NFTBOT</a>
              <!-- <h2>Здесь будет телега</h2> -->
          </div>
          <div class="words-monitor">
            <h2 class="first"></h2>
            <h2 class="second"></h2>
            <h2 class="third"></h2>
          </div>
      </section>
      <section id="about">
          <div class="container">
              <h1>О проекте</h1>
              <div class="descriptions">
                  <div class="description left">
                      <p>
                          Digital human NFT- токены, которые являются трехмерным deep fake медиаконтентом, который можно использовать для различных целей.
                      </p>
                      <img src="img/about-token.png" alt="">
                  </div>
                  <div class="description right">
                      <p>
                          Загрузите своё видео
                          в наш бот — нейросеть автоматически меняет лицо на уникальное сгенерированное
                      </p>
                      <img src="img/about-face.png" alt="">
                  </div>
                  <div class="description left">
                      <p>
                          Что это?‌Каждый Digital human NFT хранится как токен ERC-721 в блокчейне Ethereum и размещается в IPFS.
                      </p>
                      <img src="img/about-ethereum.png" alt="">
                  </div>
                  <div class="description right">
                      <p>
                          NFT поставляется
                          с полными коммерческими правами, а также с видео-аватаром, предназначенным для интеграции с метавселенной, децентрализованным миром виртуальной реальности.
                      </p>
                      <img src="img/about-docs.png" alt="">
                  </div>
              </div>
          </div>
      </section>
      <section id="sphere__section">
          <div class="container">
              <div class="title">
                <h1>А что с этим делать?</h1>
              </div>
              <svg viewBox="0 0 1200 1314" xmlns="http://www.w3.org/2000/svg">
                  <text class="title" x="600" y="657">
                      <tspan x="600" dy="1em">Сферы</tspan> <tspan x="600" dy="1em">применения</tspan></text>
                  <g class="top">
                      <path d="m 0,0
                                v -200
                                h -150
                                v -200"/>
                      <g class="sphere" transform="translate(-150 -400)">
                          <text><tspan x="0" dy="1em">Трехмерный аватар</tspan> <tspan x="0" dy="1em">для метавселенной</tspan></text>
                          <image href="img/spheres-vr.svg"/>
                      </g>
                      <path d="m 50,0
                                v -150
                                h 150
                                v -100"/>
                      <g class="sphere" transform="translate(200 -250)">
                          <text><tspan x="0" dy="1em">Уникальный</tspan> <tspan x="0" dy="1em">цифровой актив</tspan></text>
                          <image height="140" href="img/about-token.png"/>
                      </g>
                      <path d="m 100,0
                                v -100
                                h 400
                                v -100"/>
                      <g class="sphere" transform="translate(500 -200)">
                          <text><tspan x="0" dy="1em">Безопасность</tspan> <tspan x="0" dy="1em">в сети</tspan></text>
                          <image x="-10" height="140" href="img/about-face.png"/>
                      </g>
                  </g>
                  <g class="right">
                      <path d="m 0 0
                                h 150
                                v 50
                                h 150"/>
                      <g class="sphere" transform="translate(375 175)">
                          <text><tspan x="0" dy="1em">Заменитель</tspan> <tspan x="0" dy="1em">ЭЦП</tspan></text>
                          <image x="25" href="img/spheres-eds.svg"/>
                      </g>
                  </g>
                  <g class="bottom">
                      <path d="m 100 0
                                v 100
                                h 260
                                v 50"/>
                      <g class="sphere" transform="translate(370 375)">
                          <text x="10" dy="1em">Аналог KYC</text>
                          <image href="img/spheres-kyc.svg"/>
                      </g>
                      <path d="m 50 0
                                v 200
                                h 100
                                v 100"/>
                      <g class="sphere" transform="translate(150 525)">
                          <text y="5" x="10" dy="1em">Аналог паспорта</text>
                          <image href="img/spheres-pasp.svg"/>
                      </g>
                      <path d="m 0 0
                                v 150
                                h -150
                                v 100"/>
                      <g class="sphere" transform="translate(-150 475)">
                          <text y="5"><tspan x="5" dy="1em">Образ актера</tspan> <tspan x="5" dy="1em">для фильмов</tspan></text>
                          <image href="img/spheres-movie.svg"/>
                      </g>
                      <path d="m -50 0
                                v 100
                                h -350
                                v 100"/>
                      <g class="sphere" transform="translate(-410 400)">
                          <text y="-20"><tspan x="5" dy="1em">Скины для игр</tspan></text>
                          <image width="140" href="img/spheres-game.svg"/>
                      </g>
                  </g>
                  <g class="left">
                      <path d="m 0 0
                                h -150
                                v -100
                                h -175
                                v -90">
                      </path>
                      <g class="sphere" transform="translate(-330 -185)">
                          <text ><tspan x="5" dy="1em">Видеоаватар</tspan> <tspan x="5" dy="1em">для соцсетей</tspan></text>
                          <image width="140" y="-25" href="img/spheres-socials.svg"/>
                      </g>
                      <path d="m -60 50
                                h -235" />
                      <g class="sphere" transform="translate(-380 175)">
                          <text ><tspan x="5" dy="1em">Облик персонажа</tspan> <tspan x="5" dy="1em">для рекламы</tspan></text>
                          <image width="140" href="img/spheres-ad.svg"/>
                      </g>
                  </g>
              </svg>
          </div>
      </section>
        </main>
        <div class="intro">
          <div class="text">
            <h1 class="static">IGUMA - это</h1>
            <h1 class="code-text"></h1>
          </div>
          <button>start</button>
        </div>
        <svg id="hexagonMask">
      <defs>
          <clipPath clipPathUnits="objectBoundingBox" id="hexagon-clip">
              <polygon points="1 0.5, 0.75 0.9333, 0.25 0.933, 0 0.5, 0.25 0.0666, 0.75 0.0666" stroke="black" />
          </clipPath>
      </defs>
    
    </svg>
  </div>
  
</template>

<script>
import { gsap } from "gsap";
import { DrawSVGPlugin } from '~/node_modules/gsap/DrawSVGPlugin.js';
import { ScrollToPlugin } from '~/node_modules/gsap/ScrollToPlugin.js';
import { TextPlugin } from '~/node_modules/gsap/TextPlugin.js';
import { ScrollTrigger } from '~/node_modules/gsap/ScrollTrigger.js';

if (process.client) {
  gsap.registerPlugin(DrawSVGPlugin, ScrollToPlugin, TextPlugin, ScrollTrigger);
}

export default {
  head: {
    script: [
      // {src: 'app.js', body: true}
    ]
  },
  mounted() {

let black = '#00241b';
let white = '#f5f5f5';
let green = '#7ccf9e';

let logo = document.querySelector('#logo');
let header = document.querySelector('header');
let sections = gsap.utils.toArray('section');


// Scroll to top when reloading page
window.onbeforeunload = () => {
    window.scrollTo(0, 0);
};


// Intro animation

// Intro page

let introSlider = document.querySelector('.intro')
let introTextField = document.querySelector('.intro h1.code-text');
let introButton = document.querySelector('.intro button')
let introWords = ['аватар', 'DeepFake', 'цифровая_личность', 'метавселенная', 
                  'безопасность', 'цифровой_актив', 'Вы'];
let igumaIs = document.querySelector('.intro .static');
let colors = [white, green];


function shuffleArrayWithColor(array, colors) {
    for (let i = array.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]]
    }
    for (let i = array.length - 1; i >= 0; i--) {
        let binaryJ = Math.round(Math.random());
        array[i] = [array[i], colors[binaryJ]]
    }
}


shuffleArrayWithColor(introWords, colors);

let sliderTl = gsap.timeline();
sliderTl
        .to(igumaIs, {x: "0", opacity: 1, duration: .5, delay: .5})
        .to(introButton, {opacity: 1}, "0+=.75")


let sliderWordsTl = gsap.timeline({repeat: -1});
introWords.forEach(word => {
    let localTl = gsap.timeline({repeatDelay: .5, repeat: 1, yoyo: true});
    localTl.to(introTextField, {text: {value: word[0]+'.', delimiter: ""}, duration: .5});
    sliderWordsTl.add(localTl);
});

sliderTl.add(sliderWordsTl);

// Intro main page

let startButton = document.querySelector('.intro button');
startButton.addEventListener('click', () => {
  introTl.play();
});

let bannerTitle = document.querySelector('#banner .description h1');
let bannerImage = document.querySelector('#banner .clip-img img');
let bannerDescription = document.querySelector('#banner .description p');
let beehivesFirst = gsap.utils.toArray('#banner .beehive-first img');
let beehivesSecond = gsap.utils.toArray('#banner .beehive-second img');
let unions = gsap.utils.toArray('#banner img.union');
let telegramSVG = document.querySelector('#banner .telegram svg');
let telegramPath = document.querySelector('#banner .telegram path');
let telegramButton = document.querySelector('#banner .telegram a');
let wordsMonitor = document.querySelector('.words-monitor');
let notBannerSection = gsap.utils.toArray('main section:not(:first-child)');

let introTl = gsap.timeline({paused: true});
introTl.to(window, {scrollTo: "0", duration: .25})
       .to(introSlider, {y: "100%", duration: .5})
       .call(() => introSlider.classList.toggle('hidden'))
       .from(bannerTitle, {x: "-100%", y: "0", opacity: 0})
       .from(bannerDescription, {x: "-100%", y: "0", opacity: 0}, "-=.35")
       .from(bannerImage, {x: "100%", opacity: 0}, "-=.35")
       .from(unions, {x: "-100%", opacity: 0, stagger: .15}, "-=.35")
       .addLabel('startBeehives')
       .from(beehivesFirst, {opacity: 0, stagger: .1}, "startBeehives-=.35")
       .from(beehivesSecond, {opacity: 0, stagger: .1}, 'startBeehives-=.3')
       .from(header, {y: "-100%", opacity: 0}, "startBeehives-=.35")
       .from(telegramSVG, {y: "100%", opacity: 0}, "startBeehives-=.35")
       .from(telegramPath, {drawSVG: "0%"}, "startBeehives")
       .from(telegramButton, {opacity: 0}, "startBeehives+=.3")
       .from(wordsMonitor, {x: "100%", opacity: 0}, "startBeehives+=.3")
       .from(notBannerSection, {opacity: 0});


// Burger menu animation

function showBurgerMenu() {
  headerNav.classList.toggle('active');
  headerNav.classList.toggle('shadow');
  burger.classList.toggle('active');
}

let burger = document.querySelector('#burger');
let headerNav = document.querySelector('header nav');
let main = document.querySelector('main');
let navLinks = document.querySelectorAll('header nav a');

let mobileMedia = window.matchMedia('screen and (max-width: 767px)');

if (mobileMedia.matches) {
  burger.addEventListener('click', () => showBurgerMenu());

  navLinks.forEach(link => {
    link.addEventListener('click', () => showBurgerMenu())
  });
};

// Words monitor in #banner (random show words in div)


function randomNummberInRange(n) {
  let randomNumner = Math.ceil(Math.random() * n);
  return Number(randomNumner);
};

function chooseMonitorPlace() {
  let choosenMonitorTitle = wordsMonitorTitles[randomNummberInRange(3)-1];
  return choosenMonitorTitle;
};

function chooseMonitorWord() {
  let choosenWord = introWords[randomNummberInRange(introWords.length-1)];
  return String(choosenWord[0]);
};

function wordsMonitorAnimate() {
  let place = chooseMonitorPlace();
  let word =  chooseMonitorWord(); 
  let wordsMonitorTl = gsap.timeline({
    onComplete: wordsMonitorAnimate,
    defaults: {ease: "power4.out"}
    });
  wordsMonitorTl.to(place, {text: {value: word, delimiter: " "}, delay: 1, opacity: Math.random(), duration: .5})
                .to(place, {text: {value: " ", delimiter: " "}, opacity: 0});
};

let wordsMonitorTitles = document.querySelectorAll('.words-monitor h2');

wordsMonitorAnimate();

// White bg to dark bg animation
let burgerLines = gsap.utils.toArray('#burger div');
let sphereSection = document.querySelector('section#sphere__section');
let spherePaths = gsap.utils.toArray('#sphere__section path');
let blackLetters = logo.getElementById('#000000ff').querySelectorAll('path');
blackLetters = gsap.utils.toArray(blackLetters);


// When scrolling to #sphere__section, colors changes to dark
window.addEventListener('scroll', () => {
  let sphereTop = sphereSection.getBoundingClientRect().top;
  if (sphereTop <= 200) {
    darkBgTl.play();
  } else {
    darkBgTl.reverse();
  }
});

let darkBgTl = gsap.timeline({
    // scrollTrigger: {
    //     trigger: sphereSection,
    //     scrub: true,
    //     start: "top center",
    //     end: "center center"
    // },
    defaults: {
        ease: "power1.out"
    },
    paused: true
});

darkBgTl.addLabel('start')
        // .to(header, {background: white}, "start")
        .to('body', {background: black, ease: "power1.out"}, "start")
        .to(sections, {background: black, color: white, stroke: green, fill: green}, "start")
        .to(header, {background: black, color: green, borderBottom: '0px', ease: "power4.out"}, "start")
        .to(burgerLines, {backgroundColor: white}, "start")
        .to(blackLetters, {fill: "var(--background)"}, "start")
        .from(spherePaths, {drawSVG: 0})

  }
}
</script>
